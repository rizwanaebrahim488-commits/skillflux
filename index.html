<!DOCTYPE html>
<html>
<head>
  <title>SkillFlux</title>
</head>
<body>

  <h1>SkillFlux Register/Login</h1>

  <h2>Register</h2>
  <input type="email" id="regEmail" placeholder="Enter Email">
  <input type="password" id="regPassword" placeholder="Enter Password">
  <button onclick="register()">Register</button>

  <h2>Login</h2>
  <input type="email" id="loginEmail" placeholder="Enter Email">
  <input type="password" id="loginPassword" placeholder="Enter Password">
  <button onclick="login()">Login</button>

  <script type="module">
    // Import Firebase modules
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } 
      from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
      import { getFirestore, doc, setDoc } 
  from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

    // Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCHSJX5F_mZjLqPSuofyBANQ3pC69gC14o",
      authDomain: "skillflux-c4088.firebaseapp.com",
      projectId: "skillflux-c4088",
      storageBucket: "skillflux-c4088.appspot.com",
      messagingSenderId: "347039323368",
      appId: "1:347039323368:web:0f610227dc3715581a255d",
      measurementId: "G-PM1XXGSYYB"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Register function
    window.register = async function() {
  const email = document.getElementById("regEmail").value;
  const password = document.getElementById("regPassword").value;

  try {
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    const user = userCredential.user;

    // Create user document in Firestore
    await setDoc(doc(db, "users", user.uid), {
      email: user.email,
      credits: 2,
      createdAt: new Date()
    });

    alert("User Registered with 2 Credits: " + user.email);

  } catch (error) {
    alert("Error: " + error.message);
  }
}

    // Login function
    window.login = function() {
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;

      signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
          alert("Logged in as: " + userCredential.user.email);
        })
        .catch((error) => {
          alert("Error: " + error.message);
        });
    }
    
    import { onAuthStateChanged } 
  from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

onAuthStateChanged(auth, (user) => {
  if (user) {
    console.log("User logged in:", user.email);
  } else {
    console.log("No user logged in");
  }
});
  </script>

</body>
</html>
